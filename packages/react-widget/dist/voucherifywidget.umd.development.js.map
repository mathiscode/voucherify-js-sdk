{"version":3,"file":"voucherifywidget.umd.development.js","sources":["../src/VoucherifyLogo.tsx","../../../node_modules/clsx/dist/clsx.m.js","../src/helpers/index.ts","../src/hooks/useVoucherifyClient.ts","../src/hooks/useVoucherifyValidateInputs.ts","../src/VoucherifyValidate.tsx","../src/hooks/useVoucherifyPublishInputs.ts","../src/VoucherifyPublish.tsx","../src/hooks/useVoucherifyRedeemInputs.ts","../src/VoucherifyRedeem.tsx","../src/hooks/useVoucherifySubscribeInputs.ts","../src/VoucherifySubscribe.tsx"],"sourcesContent":["import * as React from 'react'\n\ninterface VoucherifyLogoProps {\n\tsrc?: string\n\talt?: string\n}\n\nexport function VoucherifyLogo({ src, alt }: VoucherifyLogoProps) {\n\treturn (\n\t\t<figure className=\"voucherifyLogo\">\n\t\t\t{src ? (\n\t\t\t\t<img className=\"voucherifyLogo\" src={src} alt={alt} />\n\t\t\t) : (\n\t\t\t\t<svg className=\"voucherifyLogo\" viewBox=\"0 0 46 45\">\n\t\t\t\t\t<path\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tfill-rule=\"nonzero\"\n\t\t\t\t\t\td=\"M18.494 3.174c2.112 2.131 3.145 4.69 3.145 7.72 0 3.032-1.033 5.59-3.145 7.722-2.112 2.131-4.647 3.173-7.651 3.173-3.004 0-5.539-1.042-7.651-3.173C1.032 16.532 0 13.926 0 10.942s1.033-5.637 3.145-7.768C5.257 1.042 7.839 0 10.843 0c2.957 0 5.539 1.042 7.65 3.174zm-7.651 1.231c-1.784 0-3.286.616-4.553 1.895-1.268 1.279-1.878 2.795-1.878 4.595 0 1.8.61 3.316 1.878 4.594 1.267 1.28 2.77 1.895 4.553 1.895 1.784 0 3.286-.616 4.553-1.895 1.267-1.278 1.877-2.794 1.877-4.594 0-1.8-.61-3.316-1.877-4.595-1.267-1.232-2.77-1.895-4.553-1.895zM34.782 44.574c-3.051-.19-5.54-1.232-7.51-3.221-2.066-2.085-3.145-5.21-3.145-8.195v-.569c0-.852.234-1.468.657-1.942.422-.426.938-.663 1.549-.663.61 0 1.126.237 1.549.663.422.427.657 1.042.657 1.895v.947c.094 1.611.704 3.553 1.877 4.69 1.268 1.279 2.77 1.895 4.553 1.895h.094c1.784 0 3.286-.616 4.553-1.895 1.174-1.137 1.784-3.079 1.878-4.69v-.947c0-.805.235-1.42.657-1.895.422-.426.939-.663 1.549-.663s1.127.237 1.549.663c.422.427.657 1.09.657 1.942v.569c-.047 2.984-1.08 6.063-3.145 8.195-1.971 1.99-4.459 3.079-7.51 3.22h-.47zM6.102 42.916c-.563 0-1.126-.237-1.596-.663-.892-.9-.892-2.321 0-3.174L40.367 2.937c.892-.9 2.3-.9 3.145 0 .892.9.892 2.32 0 3.174L7.698 42.253a2.307 2.307 0 01-1.596.663z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t)}\n\t\t</figure>\n\t)\n}\n","function toVal(mix) {\n\tvar k, y, str='';\n\n\tif (typeof mix === 'string' || typeof mix === 'number') {\n\t\tstr += mix;\n\t} else if (typeof mix === 'object') {\n\t\tif (Array.isArray(mix)) {\n\t\t\tfor (k=0; k < mix.length; k++) {\n\t\t\t\tif (mix[k]) {\n\t\t\t\t\tif (y = toVal(mix[k])) {\n\t\t\t\t\t\tstr && (str += ' ');\n\t\t\t\t\t\tstr += y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (k in mix) {\n\t\t\t\tif (mix[k]) {\n\t\t\t\t\tstr && (str += ' ');\n\t\t\t\t\tstr += k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn str;\n}\n\nexport default function () {\n\tvar i=0, tmp, x, str='';\n\twhile (i < arguments.length) {\n\t\tif (tmp = arguments[i++]) {\n\t\t\tif (x = toVal(tmp)) {\n\t\t\t\tstr && (str += ' ');\n\t\t\t\tstr += x\n\t\t\t}\n\t\t}\n\t}\n\treturn str;\n}\n","const capitalizeString = (string: string) => {\n\treturn string.charAt(0).toUpperCase() + string.slice(1)\n}\n\nexport const splitLongKey = (key: string) => {\n\treturn key\n\t\t.split('_')\n\t\t.map(k => capitalizeString(k))\n\t\t.join('')\n}\n\nexport const removeEmptyAttributes = (obj: { [x: string]: any }) => {\n\tObject.keys(obj).forEach(\n\t\tk =>\n\t\t\t(obj[k] && typeof obj[k] === 'object' && removeEmptyAttributes(obj[k])) ||\n\t\t\t(!obj[k] && (obj[k] !== undefined || obj[k] === '') && delete obj[k]),\n\t)\n\treturn obj\n}\n\nexport const validatePhoneNumber = (phoneNumber: string) => {\n\tconst re = /^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,6}$/im\n\treturn re.test(phoneNumber)\n}\n\nexport const validateEmail = (email: string) => {\n\tconst re = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/i\n\treturn re.test(email.toLowerCase())\n}\n","import { useState, useEffect } from 'react'\nimport { VoucherifyClientSide, VoucherifyClientSideOptions } from '@voucherify/sdk'\n\nexport function useVoucherifyClient(options: VoucherifyClientSideOptions) {\n\tconst [client, setClient] = useState(() => VoucherifyClientSide(options))\n\tconst [isSubmitting, setSubmitting] = useState(false)\n\n\tuseEffect(\n\t\tfunction () {\n\t\t\tsetClient(VoucherifyClientSide(options))\n\t\t},\n\t\t[options.apiUrl, options.clientApplicationId, options.clientSecretKey, options.trackingId, options.origin],\n\t)\n\n\treturn [client, isSubmitting, setSubmitting] as const\n}\n","import { VoucherifyValidateInputs, VoucherifyValidateInputsState } from '../types/VoucherifyValidate'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyValidateInputs {\n\treturn {\n\t\tvoucherifyCode: '',\n\t\tvoucherifyAmount: '',\n\t\tvoucherifyDiscountType: '',\n\t\tvoucherifyPercentOff: 0,\n\t\tvoucherifyAmountOff: 0,\n\t\tvoucherifyUnitOff: 0,\n\t\tvoucherifyTracking: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyValidateInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyValidate: false,\n\t}\n}\n\nexport function useVoucherifyValidateInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputState, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tevent.persist()\n\t\tconst name = event.target.name as keyof VoucherifyValidateInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputState,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport {\n\tClientSideValidateParams,\n\tClientSideValidateResponse,\n\tDiscountAmount,\n\tDiscountPercent,\n\tDiscountUnit,\n\tVoucherifyClientSideOptions,\n} from '@voucherify/sdk'\n\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { removeEmptyAttributes } from './helpers'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyValidateInputs } from './hooks/useVoucherifyValidateInputs'\n\ninterface VoucherifyValidateOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonValidated?: (response: ClientSideValidateResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * flag enables the amount input field\n\t */\n\tamount?: boolean\n\t/**\n\t * text displayed as a placeholder in the code input field\n\t */\n\ttextPlaceholder?: string\n\t/**\n\t * text displayed as a placeholder in the amount input field (`amount: true` is required)\n\t */\n\tamountPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Validate\")\n\t */\n\ttextValidate?: string\n}\nexport function VoucherifyValidate({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonValidated,\n\tonError,\n\tamount,\n\ttextPlaceholder,\n\tamountPlaceholder,\n\ttextValidate = 'Validate',\n}: VoucherifyValidateOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst { input, inputState, onInputChange, resetInputs, setInput, setInputState } = useVoucherifyValidateInputs()\n\n\tconst [runValidateOnce, setRunValidateOnce] = React.useState(false)\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(inputState).map(key => {\n\t\tlet className: string = key\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunValidateOnce\n\t\t\t\t? inputState[key]\n\t\t\t\t\t? `${classNameValid} ${classNameValidAnimation}`\n\t\t\t\t\t: `${classNameInvalid} ${classNameInvalidAnimation}`\n\t\t\t\t: '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyDiscountType: '',\n\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetInputState(prev => ({ ...prev, voucherifyValidate: false }))\n\n\t\t\tif (!input.voucherifyCode.trim()) {\n\t\t\t\tsetInputState(prev => ({ ...prev, voucherifyCode: false }))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst payload: ClientSideValidateParams = {\n\t\t\t\tcode: input.voucherifyCode,\n\t\t\t\tamount:\n\t\t\t\t\tinput.voucherifyAmount.trim() === '' ||\n\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t? 0\n\t\t\t\t\t\t: parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10),\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tsetSubmitting(true)\n\n\t\t\tclient\n\t\t\t\t.validate(sanitizedPayload)\n\t\t\t\t.then(function (_response) {\n\t\t\t\t\tconst response: ClientSideValidateResponse = _response\n\n\t\t\t\t\tif (!response || !response.valid) {\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyValidate: false,\n\t\t\t\t\t\t\tvoucherifyAmount: false,\n\t\t\t\t\t\t\tvoucherifyCode: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response?.discount) {\n\t\t\t\t\t\tconst responseDiscount = response?.discount as DiscountUnit | DiscountAmount | DiscountPercent\n\n\t\t\t\t\t\tswitch (responseDiscount.type) {\n\t\t\t\t\t\t\tcase 'AMOUNT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: responseDiscount.amount_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\tcase 'UNIT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: responseDiscount.unit_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\t\tcase 'PERCENT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: responseDiscount.percent_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyDiscountType: 'GIFT_CARD',\n\t\t\t\t\t\t\tvoucherifyAmountOff: response?.order?.total_discount_amount || 0,\n\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t}))\n\t\t\t\t\t}\n\n\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyValidate: true,\n\t\t\t\t\t}))\n\n\t\t\t\t\tif (typeof onValidated === 'function') onValidated(response)\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.error(err)\n\t\t\t\t\tif (err.key === 'missing_order') {\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyValidate: false,\n\t\t\t\t\t\t\tvoucherifyAmount: false,\n\t\t\t\t\t\t\tvoucherifyCode: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tsetSubmitting(false)\n\t\t\t\t\tsetRunValidateOnce(true)\n\t\t\t\t})\n\t\t},\n\t\t[input, onError, onValidated, amount],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder={textPlaceholder || 'e.g. abc-123'}\n\t\t\t\tname=\"voucherifyCode\"\n\t\t\t\tvalue={input['voucherifyCode']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyCode').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype={amount ? 'text' : 'hidden'}\n\t\t\t\tplaceholder={amountPlaceholder || 'e.g. 52.22'}\n\t\t\t\tname=\"voucherifyAmount\"\n\t\t\t\tvalue={input['voucherifyAmount']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyAmount').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyDiscountType\"\n\t\t\t\tvalue={input['voucherifyDiscountType']}\n\t\t\t\tclassName=\"voucherifyDiscountType\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyPercentOff\"\n\t\t\t\tvalue={input['voucherifyPercentOff']}\n\t\t\t\tclassName=\"voucherifyPercentOff\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyAmountOff\"\n\t\t\t\tvalue={input['voucherifyAmountOff']}\n\t\t\t\tclassName=\"voucherifyAmountOff\"\n\t\t\t/>\n\t\t\t<input type=\"hidden\" name=\"voucherifyUnitOff\" value={input['voucherifyUnitOff']} className=\"voucherifyUnitOff\" />\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyValidate').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t>\n\t\t\t\t<span className=\"voucherifyValidateText\">{textValidate}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifyPublishInputs, VoucherifyPublishInputsState } from '../types/VoucherifyPublish'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyPublishInputs {\n\treturn {\n\t\tname: '',\n\t\temail: '',\n\t\tphone: '',\n\t\tline_1: '',\n\t\tline_2: '',\n\t\tpostal_code: '',\n\t\tcity: '',\n\t\tstate: '',\n\t\tcountry: '',\n\t\tvoucherifyPublishStatus: '',\n\t\tvoucherifyTracking: '',\n\t\tvoucherifyPublish: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyPublishInputsState {\n\treturn {\n\t\tname: true,\n\t\tphone: true,\n\t\temail: true,\n\t\tline_1: true,\n\t\tline_2: true,\n\t\tpostal_code: true,\n\t\tcity: true,\n\t\tstate: true,\n\t\tcountry: true,\n\t\tvoucherifyPublishStatus: true,\n\t\tvoucherifyPublish: true,\n\t}\n}\n\nexport function useVoucherifyPublishInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifyPublishInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport { ClientSidePublishPayload, ClientSidePublishResponse, VoucherifyClientSideOptions } from '@voucherify/sdk'\nimport { removeEmptyAttributes, splitLongKey, validateEmail, validatePhoneNumber } from './helpers'\n\nimport { NotDefinedPlaceholder } from './types/VoucherifyPublish'\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyPublishInputs } from './hooks/useVoucherifyPublishInputs'\n\ninterface VoucherifyPublishOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonPublished?: (response: ClientSidePublishResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * name of the campaign to which voucher will be published\n\t */\n\tcampaignName: string\n\t/**\n\t * list of fields to be displayed on the widget\n\t */\n\tcustomerFields?: {\n\t\tname: 'name' | 'email' | 'phone' | 'line_1' | 'line_2' | 'city' | 'postal_code' | 'state' | 'country'\n\t\trequired: boolean\n\t}[]\n\t/**\n\t * a placeholder text to displayed on 'name' field from customerFields\n\t */\n\tcustomerNamePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'email' field from customerFields\n\t */\n\tcustomerEmailPlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'phone' field from customerFields\n\t */\n\tcustomerPhonePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'line_1' field from customerFields\n\t */\n\tcustomerLine1Placeholder?: string\n\t/**\n\t * a placeholder text to displayed on 'line_2' field from customerFields\n\t */\n\tcustomerLine2Placeholder?: string\n\t/**\n\t * a placeholder text to displayed on 'postal_code' field from customerFields\n\t */\n\tcustomerPostalCodePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'city' field from customerFields\n\t */\n\tcustomerCityPlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'state' field from customerFields\n\t */\n\tcustomerStatePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'country' field from customerFields\n\t */\n\tcustomerCountryPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Get Voucher\")\n\t */\n\ttextPublish?: string\n}\n\nexport function VoucherifyPublish({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonPublished,\n\tonError,\n\tcampaignName,\n\tcustomerFields = [],\n\tcustomerNamePlaceholder,\n\tcustomerEmailPlaceholder,\n\tcustomerPhonePlaceholder,\n\tcustomerLine1Placeholder,\n\tcustomerLine2Placeholder,\n\tcustomerPostalCodePlaceholder,\n\tcustomerCityPlaceholder,\n\tcustomerStatePlaceholder,\n\tcustomerCountryPlaceholder,\n\ttextPublish = 'Get voucher',\n}: VoucherifyPublishOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [visible, setVisible] = React.useState(true)\n\tconst [runPublishOnce, setRunPublishOnce] = React.useState(false)\n\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst { input, inputStates, onInputChange, resetInputs, setInput, setInputState } = useVoucherifyPublishInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(input).map(key => {\n\t\tlet className: string\n\n\t\tif (key === 'voucherifyPublishStatus' || key === 'voucherifyTracking' || key === 'voucherifyPublish') {\n\t\t\tclassName = key\n\t\t} else {\n\t\t\tclassName = `voucherifyCustomer${splitLongKey(key)}`\n\t\t}\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunPublishOnce ? (inputStates[key] ? '' : `${classNameInvalid} ${classNameInvalidAnimation}`) : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst notDefinedPlaceholders: NotDefinedPlaceholder = {\n\t\tname: 'e.g. Bruce Wayne',\n\t\temail: 'e.g. bruce@wayne.com',\n\t\tphone: 'e.g. +48 000 000 000',\n\t\tline_1: 'e.g. Wayne Manor',\n\t\tline_2: 'e.g. 22B',\n\t\tpostal_code: 'e.g. 00-0014',\n\t\tcity: 'e.g. Gotham',\n\t\tstate: 'e.g. New Jersey',\n\t\tcountry: 'e.g. USA',\n\t}\n\n\tconst createInput = (inputName: string, inputPlaceholder: string = '') => {\n\t\tlet inputType: string\n\n\t\tif (inputName === 'phone') {\n\t\t\tinputType = 'tel'\n\t\t} else if (inputName === 'email') {\n\t\t\tinputType = 'email'\n\t\t} else {\n\t\t\tinputType = 'text'\n\t\t}\n\t\treturn (\n\t\t\t<input\n\t\t\t\ttype={inputType}\n\t\t\t\tplaceholder={inputPlaceholder ? inputPlaceholder : notDefinedPlaceholders[`${inputName}`]}\n\t\t\t\tname={inputName}\n\t\t\t\tvalue={input[`${inputName}`]}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === inputName).classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t></input>\n\t\t)\n\t}\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetSubmitting(true)\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyPublishStatus: '',\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetRunPublishOnce(true)\n\n\t\t\tconst payload: ClientSidePublishPayload = {\n\t\t\t\tcustomer: {\n\t\t\t\t\tname: input.name,\n\t\t\t\t\tphone: input.phone.replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim(),\n\t\t\t\t\temail: input.email,\n\t\t\t\t\tsource_id: input.email,\n\t\t\t\t\taddress: {\n\t\t\t\t\t\tline_1: input.line_1,\n\t\t\t\t\t\tline_2: input.line_2,\n\t\t\t\t\t\tpostal_code: input.postal_code,\n\t\t\t\t\t\tcity: input.city,\n\t\t\t\t\t\tstate: input.state,\n\t\t\t\t\t\tcountry: input.country,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst inputStatesAfterValidation = customerFields.reduce(\n\t\t\t\t(result, field) => {\n\t\t\t\t\tif (field.required && input[field.name].trim() === '') {\n\t\t\t\t\t\tresult[field.name] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field.name === 'phone' && input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['phone'] = validatePhoneNumber(input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field.name === 'email' && input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['email'] = validateEmail(input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tresult[field.name] = true\n\t\t\t\t\treturn result\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: true,\n\t\t\t\t\temail: true,\n\t\t\t\t\tphone: true,\n\t\t\t\t\tline_1: true,\n\t\t\t\t\tline_2: true,\n\t\t\t\t\tpostal_code: true,\n\t\t\t\t\tcity: true,\n\t\t\t\t\tstate: true,\n\t\t\t\t\tcountry: true,\n\t\t\t\t\tvoucherifyPublishStatus: true,\n\t\t\t\t\tvoucherifyPublish: true,\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tsetInputState(prev => ({\n\t\t\t\t...prev,\n\t\t\t\t...inputStatesAfterValidation,\n\t\t\t}))\n\n\t\t\tconst validationFailed = Object.values(inputStatesAfterValidation).some(val => !val)\n\n\t\t\tif (!validationFailed) {\n\t\t\t\tclient\n\t\t\t\t\t.publish(campaignName, sanitizedPayload)\n\t\t\t\t\t.then(function (_response) {\n\t\t\t\t\t\tconst response: ClientSidePublishResponse = _response\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\temail: '',\n\t\t\t\t\t\t\tphone: '',\n\t\t\t\t\t\t\tline_1: '',\n\t\t\t\t\t\t\tline_2: '',\n\t\t\t\t\t\t\tpostal_code: '',\n\t\t\t\t\t\t\tcity: '',\n\t\t\t\t\t\t\tstate: '',\n\t\t\t\t\t\t\tcountry: '',\n\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\tvoucherifyPublishStatus: response.voucher.code,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tsetDisabled(true)\n\t\t\t\t\t\tsetVisible(false)\n\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyPublishStatus: true,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onPublished === 'function') onPublished(response)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyPublish: false,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => setSubmitting(false))\n\t\t\t} else {\n\t\t\t\tsetSubmitting(false)\n\t\t\t}\n\t\t},\n\t\t[input, onError, onPublished],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer wide\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\n\t\t\t{customerFields.some(val => val.name === 'name') && createInput('name', customerNamePlaceholder)}\n\n\t\t\t{customerFields.some(val => val.name === 'email' || val.name === 'phone') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'email') && createInput('email', customerEmailPlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'phone') && createInput('phone', customerPhonePlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{customerFields.some(val => val.name === 'line_1') && createInput('line_1', customerLine1Placeholder)}\n\t\t\t{customerFields.some(val => val.name === 'line_2') && createInput('line_2', customerLine2Placeholder)}\n\n\t\t\t{customerFields.some(val => val.name === 'postal_code' || val.name === 'city') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code') &&\n\t\t\t\t\t\tcreateInput('postal_code', customerPostalCodePlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'city') && createInput('city', customerCityPlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{customerFields.some(val => val.name === 'state' || val.name === 'country') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'state') && createInput('state', customerStatePlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'country') && createInput('country', customerCountryPlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tname=\"voucherifyPublishStatus\"\n\t\t\t\tclassName={`voucherifyPublishStatus ${classNameValid} ${classNameValidAnimation}`}\n\t\t\t\tvalue={input['voucherifyPublishStatus']}\n\t\t\t\tstyle={{ display: !visible ? 'block' : 'none' }}\n\t\t\t/>\n\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyPublish').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t>\n\t\t\t\t<span className=\"VoucherifyPublishText\">{textPublish}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifyRedeemInputs, VoucherifyRedeemInputsState } from '../types/VoucherifyRedeem'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyRedeemInputs {\n\treturn {\n\t\tvoucherifyCode: '',\n\t\tvoucherifyAmount: '',\n\t\tvoucherifyTracking: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyRedeemInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyRedeem: false,\n\t}\n}\n\nfunction getEmptyValidInputState(): VoucherifyRedeemInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyRedeem: false,\n\t}\n}\n\nexport function useVoucherifyRedeemInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\tconst [inputValidStates, setValidInputState] = useState(getEmptyValidInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifyRedeemInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tinputValidStates,\n\t\tsetValidInputState,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport { ClientSideRedeemResponse, ClientSideRedeemWidgetPayload, VoucherifyClientSideOptions } from '@voucherify/sdk'\n\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { removeEmptyAttributes } from './helpers'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyRedeemInputs } from './hooks/useVoucherifyRedeemInputs'\n\ninterface VoucherifyRedeemOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonRedeemed?: (response: ClientSideRedeemResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * flag enables the amount input field\n\t */\n\tamount?: boolean\n\t/**\n\t * text displayed as a placeholder in the code input field\n\t */\n\ttextPlaceholder?: string\n\t/**\n\t * text displayed as a placeholder in the amount input field (`amount: true` is required)\n\t */\n\tamountPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Redeem\")\n\t */\n\ttextRedeem?: string\n}\n\nexport function VoucherifyRedeem({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonRedeemed,\n\tonError,\n\tamount,\n\ttextPlaceholder,\n\tamountPlaceholder,\n\ttextRedeem = 'Redeem',\n}: VoucherifyRedeemOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [runRedeemOnce, setRunRedeemOnce] = React.useState(false)\n\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t\tinputValidStates,\n\t\tsetValidInputState,\n\t} = useVoucherifyRedeemInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(inputStates).map(key => {\n\t\tlet className: string = key\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunRedeemOnce ? (inputStates[key] ? `${classNameInvalid} ${classNameInvalidAnimation}` : '') : '',\n\t\t\trunRedeemOnce ? (inputValidStates[key] ? `${classNameValid} ${classNameValidAnimation}` : '') : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetRunRedeemOnce(true)\n\n\t\t\tconst payload: ClientSideRedeemWidgetPayload = {\n\t\t\t\torder: {\n\t\t\t\t\tamount:\n\t\t\t\t\t\tinput.voucherifyAmount.trim() === '' ||\n\t\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t\t? 0\n\t\t\t\t\t\t\t: parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10),\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst code: string = input.voucherifyCode.replace(/[\\r\\n\\t\\f\\v]/g, '').trim()\n\n\t\t\tif (\n\t\t\t\t!code ||\n\t\t\t\t(input.voucherifyAmount.trim() !== '' &&\n\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10)))\n\t\t\t) {\n\t\t\t\treturn setInputState(prev => ({\n\t\t\t\t\t...prev,\n\t\t\t\t\tvoucherifyCode: !code ? true : false,\n\t\t\t\t\tvoucherifyAmount:\n\t\t\t\t\t\tamount && isNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t: false,\n\t\t\t\t}))\n\t\t\t}\n\n\t\t\tsetSubmitting(true)\n\n\t\t\tclient\n\t\t\t\t.redeem(code, sanitizedPayload)\n\t\t\t\t.then(function (_response) {\n\t\t\t\t\tconst response: ClientSideRedeemResponse = _response\n\t\t\t\t\tif (!response || response.result !== 'SUCCESS') {\n\t\t\t\t\t\tsetInputState(prev => ({ ...prev, voucherifyRedeem: true }))\n\t\t\t\t\t}\n\n\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t}))\n\n\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\tsetValidInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyRedeem: true,\n\t\t\t\t\t}))\n\n\t\t\t\t\tif (typeof onRedeemed === 'function') onRedeemed(response)\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.error(err)\n\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyRedeem: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t}))\n\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t})\n\t\t\t\t.finally(() => setSubmitting(false))\n\t\t},\n\t\t[input, onError, onRedeemed, amount],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder={textPlaceholder || 'e.g. abc-123'}\n\t\t\t\tname=\"voucherifyCode\"\n\t\t\t\tvalue={input['voucherifyCode']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyCode').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype={amount ? 'text' : 'hidden'}\n\t\t\t\tplaceholder={amountPlaceholder || 'e.g. 52.22'}\n\t\t\t\tname=\"voucherifyAmount\"\n\t\t\t\tvalue={input['voucherifyAmount']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyAmount').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyRedeem').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t>\n\t\t\t\t<span className=\"voucherifyRedeemText\">{textRedeem}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifySubscribeInputs, VoucherifySubscribeInputsState } from '../types/VoucherifySubscribe'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifySubscribeInputs {\n\treturn {\n\t\tname: '',\n\t\temail: '',\n\t\tphone: '',\n\t\tline_1: '',\n\t\tline_2: '',\n\t\tpostal_code: '',\n\t\tcity: '',\n\t\tstate: '',\n\t\tcountry: '',\n\t\tvoucherifySubscribeStatus: '',\n\t\tvoucherifySubscribe: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifySubscribeInputsState {\n\treturn {\n\t\tname: true,\n\t\tphone: true,\n\t\temail: true,\n\t\tline_1: true,\n\t\tline_2: true,\n\t\tpostal_code: true,\n\t\tcity: true,\n\t\tstate: true,\n\t\tcountry: true,\n\t\tvoucherifySubscribeStatus: true,\n\t\tvoucherifySubscribe: true,\n\t}\n}\n\nexport function useVoucherifySubscribeInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifySubscribeInputs\n\n\t\tif (event.target.value === 'off') {\n\t\t\tsetInput(prev => ({ ...prev, [name]: 'on' }))\n\t\t} else if (event.target.value === 'on') {\n\t\t\tsetInput(prev => ({ ...prev, [name]: 'off' }))\n\t\t} else {\n\t\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t\t}\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport {\n\tClientSideCustomersCreateParams,\n\tClientSideCustomersCreateResponse,\n\tVoucherifyClientSideOptions,\n} from '@voucherify/sdk'\nimport { removeEmptyAttributes, splitLongKey, validateEmail, validatePhoneNumber } from './helpers'\n\nimport { NotDefinedPlaceholder } from './types/VoucherifyPublish'\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport { VoucherifySubscribeLoadedConsents } from './types/VoucherifySubscribe'\nimport clsx from 'clsx'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifySubscribeInputs } from './hooks/useVoucherifySubscribeInputs'\n\nconst UNCONFIRMED_CUSTOMER = 'Confirm your subscription to our list. Check your email for further instructions.'\nconst ERROR_MESSAGE =\n\t'We ran into a configuration error. Please try that again. If the error persists, please contact support.'\n\ninterface WidgetFields {\n\tname?: 'name' | 'email' | 'phone' | 'line_1' | 'line_2' | 'city' | 'postal_code' | 'state' | 'country'\n\trequired: boolean\n\tplaceholder?: string\n\tid?: string\n}\n\ninterface Consents {\n\tid: string\n\trequired: boolean\n}\ninterface VoucherifySubscribeOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when data is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when data is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when data is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when data is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the data is valid, it takes the updateConsents response as a parameter\n\t */\n\tonSubscribed?: (response: any) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * require customer to confirm subscription by email\n\t */\n\tenableDoubleOptIn?: boolean\n\t/**\n\t * list of fields to be displayed on the widget\n\t */\n\tcustomerFields?: WidgetFields[]\n\t/**\n\t * a placeholder text to displayed on required 'email' field\n\t */\n\temailPlaceholder: string\n\t/**\n\t * list of consent objects to be displayed on the widget\n\t */\n\tconsents: Consents[]\n\t/**\n\t * a text displayed on the button (default: \"Subscribe\")\n\t */\n\ttextSubscribe?: string\n\t/**\n\t * a text displayed after successful subscription (default: \"Thank you for subscribing\")\n\t */\n\ttextSubscribeSuccess?: string\n}\n\nexport function VoucherifySubscribe({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tconsents,\n\tonSubscribed,\n\tonError,\n\temailPlaceholder,\n\tcustomerFields = [],\n\tenableDoubleOptIn = false,\n\ttextSubscribe = 'Subscribe',\n\ttextSubscribeSuccess = 'Thank you for subscribing',\n}: VoucherifySubscribeOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [visible, setVisible] = React.useState(true)\n\tconst [runSubscribeOnce, setRunSubscribeOnce] = React.useState(false)\n\tconst [consentsError, setConsentsError] = React.useState(false)\n\tconst [loading, setLoading] = React.useState(true)\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\tconst [loadedConsents, setLoadedConsents] = React.useState<VoucherifySubscribeLoadedConsents>([])\n\n\tconst widgetFields: WidgetFields[] = [\n\t\t...customerFields,\n\t\t{ name: 'email', required: true, placeholder: emailPlaceholder },\n\t\t...consents,\n\t]\n\n\tconst { input, inputStates, onInputChange, resetInputs, setInput, setInputState } = useVoucherifySubscribeInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst onRender = React.useCallback(\n\t\tfunction _onRender() {\n\t\t\tif (!enableDoubleOptIn && consents !== [] && consents !== undefined) {\n\t\t\t\tclient\n\t\t\t\t\t.listConsents()\n\t\t\t\t\t.then(fetchedData => {\n\t\t\t\t\t\tconst fetchedConsents = fetchedData.consents.data\n\t\t\t\t\t\tconst filteredConsents = fetchedConsents.filter(o1 => consents.some(o2 => o1.id === o2?.id))\n\t\t\t\t\t\tif (filteredConsents.length === 0 || filteredConsents.length !== consents.length) {\n\t\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus: true,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetConsentsError(true)\n\t\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst foundConsents: any = {}\n\t\t\t\t\t\t\tconst foundConsentsStates: any = {}\n\n\t\t\t\t\t\t\tfilteredConsents.forEach(consent => {\n\t\t\t\t\t\t\t\tfoundConsents[consent.id] = ''\n\t\t\t\t\t\t\t\tfoundConsentsStates[consent.id] = true\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t...foundConsents,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t...foundConsentsStates,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetLoadedConsents(filteredConsents)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetLoading(false)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tsetLoading(false)\n\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribe: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tsetLoading(false)\n\t\t\t}\n\t\t},\n\t\t[enableDoubleOptIn, consentsError],\n\t)\n\n\tReact.useEffect(() => {\n\t\tonRender()\n\t}, [onRender])\n\n\tconst classNames: any[] = Object.keys(input).map(key => {\n\t\tlet className: string\n\n\t\tif (key === 'voucherifySubscribeStatus' || key === 'voucherifySubscribe') {\n\t\t\tclassName = key\n\t\t} else {\n\t\t\tclassName = `voucherifyCustomer${splitLongKey(key)}`\n\t\t}\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunSubscribeOnce ? (inputStates[key] ? '' : `${classNameInvalid} ${classNameInvalidAnimation}`) : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst notDefinedPlaceholders: NotDefinedPlaceholder = {\n\t\tname: 'e.g. Bruce Wayne',\n\t\temail: 'e.g. bruce@wayne.com',\n\t\tphone: 'e.g. +48 000 000 000',\n\t\tline_1: 'e.g. Wayne Manor',\n\t\tline_2: 'e.g. 22B',\n\t\tpostal_code: 'e.g. 00-0014',\n\t\tcity: 'e.g. Gotham',\n\t\tstate: 'e.g. New Jersey',\n\t\tcountry: 'e.g. USA',\n\t}\n\n\tconst createInput = (inputName: string, inputPlaceholder: string = '') => {\n\t\tlet inputType: string\n\n\t\tif (inputName === 'phone') {\n\t\t\tinputType = 'tel'\n\t\t} else if (inputName === 'email') {\n\t\t\tinputType = 'email'\n\t\t} else {\n\t\t\tinputType = 'text'\n\t\t}\n\t\treturn (\n\t\t\t<input\n\t\t\t\ttype={inputType}\n\t\t\t\tplaceholder={inputPlaceholder ? inputPlaceholder : notDefinedPlaceholders[`${inputName}`]}\n\t\t\t\tname={inputName}\n\t\t\t\tvalue={input[`${inputName}`]}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === inputName).classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t></input>\n\t\t)\n\t}\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetSubmitting(true)\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifySubscribeStatus: '',\n\t\t\t}))\n\n\t\t\tsetRunSubscribeOnce(true)\n\n\t\t\tconst payload: ClientSideCustomersCreateParams = {\n\t\t\t\tsource_id: input.email,\n\t\t\t\tname: input.name,\n\t\t\t\tphone: input.phone.replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim(),\n\t\t\t\temail: input.email,\n\t\t\t\taddress: {\n\t\t\t\t\tline_1: input.line_1,\n\t\t\t\t\tline_2: input.line_2,\n\t\t\t\t\tpostal_code: input.postal_code,\n\t\t\t\t\tcity: input.city,\n\t\t\t\t\tstate: input.state,\n\t\t\t\t\tcountry: input.country,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst inputStatesAfterValidation = widgetFields.reduce(\n\t\t\t\t(result, field) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!enableDoubleOptIn &&\n\t\t\t\t\t\tfield?.required &&\n\t\t\t\t\t\tfield?.id &&\n\t\t\t\t\t\t(input[field.id] === 'off' || input[field.id].trim() === '')\n\t\t\t\t\t) {\n\t\t\t\t\t\tresult[field.id] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.required && field?.name && input[field.name].trim() === '') {\n\t\t\t\t\t\tresult[field.name] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name === 'phone' && input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['phone'] = validatePhoneNumber(input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name === 'email' && input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['email'] = validateEmail(input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name) {\n\t\t\t\t\t\tresult[field.name] = true\n\t\t\t\t\t} else if (field?.id) {\n\t\t\t\t\t\tresult[field.id] = true\n\t\t\t\t\t}\n\t\t\t\t\treturn result\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t...inputStates,\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tsetInputState(prev => ({\n\t\t\t\t...prev,\n\t\t\t\t...inputStatesAfterValidation,\n\t\t\t}))\n\n\t\t\tconst validationFailed = Object.values(inputStatesAfterValidation).some(val => !val)\n\n\t\t\tif (!validationFailed) {\n\t\t\t\tclient\n\t\t\t\t\t.createCustomer(sanitizedPayload, enableDoubleOptIn)\n\t\t\t\t\t.then(function (_response: ClientSideCustomersCreateResponse) {\n\t\t\t\t\t\tif (_response.object === 'unconfirmed_customer') {\n\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus: UNCONFIRMED_CUSTOMER,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribeStatus: textSubscribeSuccess,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (loadedConsents.length !== 0) {\n\t\t\t\t\t\t\tconst createdCustomerId = _response.id\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\temail,\n\t\t\t\t\t\t\t\tphone,\n\t\t\t\t\t\t\t\tline_1,\n\t\t\t\t\t\t\t\tline_2,\n\t\t\t\t\t\t\t\tpostal_code,\n\t\t\t\t\t\t\t\tcity,\n\t\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\t\tcountry,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus,\n\t\t\t\t\t\t\t\tvoucherifySubscribe,\n\t\t\t\t\t\t\t\tvoucherifyTracking,\n\t\t\t\t\t\t\t\t...consents\n\t\t\t\t\t\t\t} = input\n\n\t\t\t\t\t\t\tObject.keys(consents).forEach(function (key) {\n\t\t\t\t\t\t\t\tconsents[key] = consents[key] === 'on'\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\treturn client.updateConsents(createdCustomerId, consents)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn\n\t\t\t\t\t})\n\t\t\t\t\t.then(function (_response) {\n\t\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\t\tsetVisible(false)\n\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribeStatus: true,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\temail: '',\n\t\t\t\t\t\t\tphone: '',\n\t\t\t\t\t\t\tline_1: '',\n\t\t\t\t\t\t\tline_2: '',\n\t\t\t\t\t\t\tpostal_code: '',\n\t\t\t\t\t\t\tcity: '',\n\t\t\t\t\t\t\tstate: '',\n\t\t\t\t\t\t\tcountry: '',\n\t\t\t\t\t\t\tvoucherifySubscribe: '',\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onSubscribed === 'function') onSubscribed(_response)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribe: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => setSubmitting(false))\n\t\t\t} else {\n\t\t\t\tsetSubmitting(false)\n\t\t\t}\n\t\t},\n\t\t[input, onError, onSubscribed],\n\t)\n\treturn (\n\t\t<div className=\"voucherifyContainer wide\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\n\t\t\t{loading ? (\n\t\t\t\t<div className=\"loader\">Loading consents...</div>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{customerFields.some(val => val.name === 'name') &&\n\t\t\t\t\t\tcreateInput('name', customerFields.find(field => field.name === 'name')?.placeholder)}\n\n\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t{createInput('email', emailPlaceholder)}\n\t\t\t\t\t\t{customerFields.some(val => val.name === 'phone') &&\n\t\t\t\t\t\t\tcreateInput('phone', customerFields.find(field => field.name === 'phone')?.placeholder)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'line_1') &&\n\t\t\t\t\t\tcreateInput('line_1', customerFields.find(field => field.name === 'line_1')?.placeholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'line_2') &&\n\t\t\t\t\t\tcreateInput('line_2', customerFields.find(field => field.name === 'line_2')?.placeholder)}\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code' || val.name === 'city') && (\n\t\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code') &&\n\t\t\t\t\t\t\t\tcreateInput('postal_code', customerFields.find(field => field.name === 'postal_code')?.placeholder)}\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'city') &&\n\t\t\t\t\t\t\t\tcreateInput('city', customerFields.find(field => field.name === 'city')?.placeholder)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'state' || val.name === 'country') && (\n\t\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'state') &&\n\t\t\t\t\t\t\t\tcreateInput('state', customerFields.find(field => field.name === 'state')?.placeholder)}\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'country') &&\n\t\t\t\t\t\t\t\tcreateInput('country', customerFields.find(field => field.name === 'country')?.placeholder)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\tconsentsError\n\t\t\t\t\t\t\t\t? `voucherifySubscribeStatus ${classNameInvalid} ${classNameInvalidAnimation}`\n\t\t\t\t\t\t\t\t: `voucherifySubscribeStatus ${classNameValid} ${classNameValidAnimation}`\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyle={{ display: !visible ? 'block' : 'none' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<p>{input['voucherifySubscribeStatus']}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{!enableDoubleOptIn &&\n\t\t\t\t\t\tloadedConsents.length !== 0 &&\n\t\t\t\t\t\tloadedConsents.map((consent: any) => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{classNames.some(val => val.name === consent.id) && (\n\t\t\t\t\t\t\t\t\t<label className=\"voucherifyCheckboxContainer\" style={{ display: visible ? 'block' : 'none' }}>\n\t\t\t\t\t\t\t\t\t\t{consent.description}\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\t\tid={consent.name}\n\t\t\t\t\t\t\t\t\t\t\tname={consent.id}\n\t\t\t\t\t\t\t\t\t\t\tonChange={onInputChange}\n\t\t\t\t\t\t\t\t\t\t\tvalue={input[consent.id] === 'on' ? 'on' : 'off'}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tclassName={`voucherifyCheckmark ${\n\t\t\t\t\t\t\t\t\t\t\t\tclassNames.find((cls: any) => cls.name === consent.id).classes\n\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t))}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifySubscribe').classes}\n\t\t\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\t\t\tonClick={onSubmit}\n\t\t\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"voucherifySubscribeText\">{textSubscribe}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n"],"names":["VoucherifyLogo","src","alt","React","className","viewBox","fill","d","toVal","mix","k","y","str","Array","isArray","length","i","tmp","x","arguments","capitalizeString","string","charAt","toUpperCase","slice","splitLongKey","key","split","map","join","removeEmptyAttributes","obj","Object","keys","forEach","undefined","validatePhoneNumber","phoneNumber","re","test","validateEmail","email","toLowerCase","useVoucherifyClient","options","useState","VoucherifyClientSide","client","setClient","isSubmitting","setSubmitting","useEffect","apiUrl","clientApplicationId","clientSecretKey","trackingId","origin","getEmptyInputs","voucherifyCode","voucherifyAmount","voucherifyDiscountType","voucherifyPercentOff","voucherifyAmountOff","voucherifyUnitOff","voucherifyTracking","getEmptyInputState","voucherifyValidate","useVoucherifyValidateInputs","input","setInput","inputState","setInputState","onInputChange","useCallback","onChange","event","persist","name","target","prev","value","resetInputs","reset","VoucherifyValidate","classInvalid","classInvalidAnimation","classValid","classValidAnimation","logoSrc","logoAlt","onValidated","onError","amount","textPlaceholder","amountPlaceholder","textValidate","classNameInvalid","classNameValid","classNameInvalidAnimation","classNameValidAnimation","allDisabled","setDisabled","runValidateOnce","setRunValidateOnce","classNames","classes","clsx","onSubmit","_event","trim","payload","code","isNaN","parseInt","parseFloat","replace","toString","sanitizedPayload","validate","then","_response","response","valid","discount","responseDiscount","type","amount_off","tracking_id","unit_off","percent_off","order","total_discount_amount","err","console","error","placeholder","find","cls","disabled","onClick","phone","line_1","line_2","postal_code","city","state","country","voucherifyPublishStatus","voucherifyPublish","useVoucherifyPublishInputs","inputStates","VoucherifyPublish","onPublished","campaignName","customerFields","customerNamePlaceholder","customerEmailPlaceholder","customerPhonePlaceholder","customerLine1Placeholder","customerLine2Placeholder","customerPostalCodePlaceholder","customerCityPlaceholder","customerStatePlaceholder","customerCountryPlaceholder","textPublish","visible","setVisible","runPublishOnce","setRunPublishOnce","notDefinedPlaceholders","createInput","inputName","inputPlaceholder","inputType","style","display","customer","source_id","address","inputStatesAfterValidation","reduce","result","field","required","validationFailed","values","some","val","publish","voucher","voucherifyRedeem","getEmptyValidInputState","useVoucherifyRedeemInputs","inputValidStates","setValidInputState","VoucherifyRedeem","onRedeemed","textRedeem","runRedeemOnce","setRunRedeemOnce","redeem","voucherifySubscribeStatus","voucherifySubscribe","useVoucherifySubscribeInputs","UNCONFIRMED_CUSTOMER","ERROR_MESSAGE","VoucherifySubscribe","consents","onSubscribed","emailPlaceholder","enableDoubleOptIn","textSubscribe","textSubscribeSuccess","runSubscribeOnce","setRunSubscribeOnce","consentsError","setConsentsError","loading","setLoading","loadedConsents","setLoadedConsents","widgetFields","onRender","_onRender","listConsents","fetchedData","fetchedConsents","data","filteredConsents","filter","o1","o2","id","foundConsents","foundConsentsStates","consent","createCustomer","object","createdCustomerId","updateConsents","description"],"mappings":"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"}