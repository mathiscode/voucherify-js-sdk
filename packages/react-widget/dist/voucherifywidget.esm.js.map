{"version":3,"file":"voucherifywidget.esm.js","sources":["../src/VoucherifyLogo.tsx","../../../node_modules/clsx/dist/clsx.m.js","../src/helpers/index.ts","../src/hooks/useVoucherifyClient.ts","../src/hooks/useVoucherifyValidateInputs.ts","../src/VoucherifyValidate.tsx","../src/hooks/useVoucherifyPublishInputs.ts","../src/VoucherifyPublish.tsx","../src/hooks/useVoucherifyRedeemInputs.ts","../src/VoucherifyRedeem.tsx","../src/hooks/useVoucherifySubscribeInputs.ts","../src/VoucherifySubscribe.tsx"],"sourcesContent":["import * as React from 'react'\n\ninterface VoucherifyLogoProps {\n\tsrc?: string\n\talt?: string\n}\n\nexport function VoucherifyLogo({ src, alt }: VoucherifyLogoProps) {\n\treturn (\n\t\t<figure className=\"voucherifyLogo\">\n\t\t\t{src ? (\n\t\t\t\t<img className=\"voucherifyLogo\" src={src} alt={alt} />\n\t\t\t) : (\n\t\t\t\t<svg className=\"voucherifyLogo\" viewBox=\"0 0 46 45\">\n\t\t\t\t\t<path\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tfill-rule=\"nonzero\"\n\t\t\t\t\t\td=\"M18.494 3.174c2.112 2.131 3.145 4.69 3.145 7.72 0 3.032-1.033 5.59-3.145 7.722-2.112 2.131-4.647 3.173-7.651 3.173-3.004 0-5.539-1.042-7.651-3.173C1.032 16.532 0 13.926 0 10.942s1.033-5.637 3.145-7.768C5.257 1.042 7.839 0 10.843 0c2.957 0 5.539 1.042 7.65 3.174zm-7.651 1.231c-1.784 0-3.286.616-4.553 1.895-1.268 1.279-1.878 2.795-1.878 4.595 0 1.8.61 3.316 1.878 4.594 1.267 1.28 2.77 1.895 4.553 1.895 1.784 0 3.286-.616 4.553-1.895 1.267-1.278 1.877-2.794 1.877-4.594 0-1.8-.61-3.316-1.877-4.595-1.267-1.232-2.77-1.895-4.553-1.895zM34.782 44.574c-3.051-.19-5.54-1.232-7.51-3.221-2.066-2.085-3.145-5.21-3.145-8.195v-.569c0-.852.234-1.468.657-1.942.422-.426.938-.663 1.549-.663.61 0 1.126.237 1.549.663.422.427.657 1.042.657 1.895v.947c.094 1.611.704 3.553 1.877 4.69 1.268 1.279 2.77 1.895 4.553 1.895h.094c1.784 0 3.286-.616 4.553-1.895 1.174-1.137 1.784-3.079 1.878-4.69v-.947c0-.805.235-1.42.657-1.895.422-.426.939-.663 1.549-.663s1.127.237 1.549.663c.422.427.657 1.09.657 1.942v.569c-.047 2.984-1.08 6.063-3.145 8.195-1.971 1.99-4.459 3.079-7.51 3.22h-.47zM6.102 42.916c-.563 0-1.126-.237-1.596-.663-.892-.9-.892-2.321 0-3.174L40.367 2.937c.892-.9 2.3-.9 3.145 0 .892.9.892 2.32 0 3.174L7.698 42.253a2.307 2.307 0 01-1.596.663z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t)}\n\t\t</figure>\n\t)\n}\n","function toVal(mix) {\n\tvar k, y, str='';\n\n\tif (typeof mix === 'string' || typeof mix === 'number') {\n\t\tstr += mix;\n\t} else if (typeof mix === 'object') {\n\t\tif (Array.isArray(mix)) {\n\t\t\tfor (k=0; k < mix.length; k++) {\n\t\t\t\tif (mix[k]) {\n\t\t\t\t\tif (y = toVal(mix[k])) {\n\t\t\t\t\t\tstr && (str += ' ');\n\t\t\t\t\t\tstr += y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (k in mix) {\n\t\t\t\tif (mix[k]) {\n\t\t\t\t\tstr && (str += ' ');\n\t\t\t\t\tstr += k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn str;\n}\n\nexport default function () {\n\tvar i=0, tmp, x, str='';\n\twhile (i < arguments.length) {\n\t\tif (tmp = arguments[i++]) {\n\t\t\tif (x = toVal(tmp)) {\n\t\t\t\tstr && (str += ' ');\n\t\t\t\tstr += x\n\t\t\t}\n\t\t}\n\t}\n\treturn str;\n}\n","const capitalizeString = (string: string) => {\n\treturn string.charAt(0).toUpperCase() + string.slice(1)\n}\n\nexport const splitLongKey = (key: string) => {\n\treturn key\n\t\t.split('_')\n\t\t.map(k => capitalizeString(k))\n\t\t.join('')\n}\n\nexport const removeEmptyAttributes = (obj: { [x: string]: any }) => {\n\tObject.keys(obj).forEach(\n\t\tk =>\n\t\t\t(obj[k] && typeof obj[k] === 'object' && removeEmptyAttributes(obj[k])) ||\n\t\t\t(!obj[k] && (obj[k] !== undefined || obj[k] === '') && delete obj[k]),\n\t)\n\treturn obj\n}\n\nexport const validatePhoneNumber = (phoneNumber: string) => {\n\tconst re = /^[+]?[(]?[0-9]{3}[)]?[-\\s.]?[0-9]{3}[-\\s.]?[0-9]{4,6}$/im\n\treturn re.test(phoneNumber)\n}\n\nexport const validateEmail = (email: string) => {\n\tconst re = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@(([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{2,})$/i\n\treturn re.test(email.toLowerCase())\n}\n","import { useState, useEffect } from 'react'\nimport { VoucherifyClientSide, VoucherifyClientSideOptions } from '@voucherify/sdk'\n\nexport function useVoucherifyClient(options: VoucherifyClientSideOptions) {\n\tconst [client, setClient] = useState(() => VoucherifyClientSide(options))\n\tconst [isSubmitting, setSubmitting] = useState(false)\n\n\tuseEffect(\n\t\tfunction () {\n\t\t\tsetClient(VoucherifyClientSide(options))\n\t\t},\n\t\t[options.apiUrl, options.clientApplicationId, options.clientSecretKey, options.trackingId, options.origin],\n\t)\n\n\treturn [client, isSubmitting, setSubmitting] as const\n}\n","import { VoucherifyValidateInputs, VoucherifyValidateInputsState } from '../types/VoucherifyValidate'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyValidateInputs {\n\treturn {\n\t\tvoucherifyCode: '',\n\t\tvoucherifyAmount: '',\n\t\tvoucherifyDiscountType: '',\n\t\tvoucherifyPercentOff: 0,\n\t\tvoucherifyAmountOff: 0,\n\t\tvoucherifyUnitOff: 0,\n\t\tvoucherifyTracking: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyValidateInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyValidate: false,\n\t}\n}\n\nexport function useVoucherifyValidateInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputState, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tevent.persist()\n\t\tconst name = event.target.name as keyof VoucherifyValidateInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputState,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport {\n\tClientSideValidateParams,\n\tClientSideValidateResponse,\n\tDiscountAmount,\n\tDiscountPercent,\n\tDiscountUnit,\n\tVoucherifyClientSideOptions,\n} from '@voucherify/sdk'\n\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { removeEmptyAttributes } from './helpers'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyValidateInputs } from './hooks/useVoucherifyValidateInputs'\n\ninterface VoucherifyValidateOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonValidated?: (response: ClientSideValidateResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * flag enables the amount input field\n\t */\n\tamount?: boolean\n\t/**\n\t * text displayed as a placeholder in the code input field\n\t */\n\ttextPlaceholder?: string\n\t/**\n\t * text displayed as a placeholder in the amount input field (`amount: true` is required)\n\t */\n\tamountPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Validate\")\n\t */\n\ttextValidate?: string\n}\nexport function VoucherifyValidate({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonValidated,\n\tonError,\n\tamount,\n\ttextPlaceholder,\n\tamountPlaceholder,\n\ttextValidate = 'Validate',\n}: VoucherifyValidateOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst { input, inputState, onInputChange, resetInputs, setInput, setInputState } = useVoucherifyValidateInputs()\n\n\tconst [runValidateOnce, setRunValidateOnce] = React.useState(false)\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(inputState).map(key => {\n\t\tlet className: string = key\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunValidateOnce\n\t\t\t\t? inputState[key]\n\t\t\t\t\t? `${classNameValid} ${classNameValidAnimation}`\n\t\t\t\t\t: `${classNameInvalid} ${classNameInvalidAnimation}`\n\t\t\t\t: '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyDiscountType: '',\n\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetInputState(prev => ({ ...prev, voucherifyValidate: false }))\n\n\t\t\tif (!input.voucherifyCode.trim()) {\n\t\t\t\tsetInputState(prev => ({ ...prev, voucherifyCode: false }))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst payload: ClientSideValidateParams = {\n\t\t\t\tcode: input.voucherifyCode,\n\t\t\t\tamount:\n\t\t\t\t\tinput.voucherifyAmount.trim() === '' ||\n\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t? 0\n\t\t\t\t\t\t: parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10),\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tsetSubmitting(true)\n\n\t\t\tclient\n\t\t\t\t.validate(sanitizedPayload)\n\t\t\t\t.then(function (_response) {\n\t\t\t\t\tconst response: ClientSideValidateResponse = _response\n\n\t\t\t\t\tif (!response || !response.valid) {\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyValidate: false,\n\t\t\t\t\t\t\tvoucherifyAmount: false,\n\t\t\t\t\t\t\tvoucherifyCode: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response?.discount) {\n\t\t\t\t\t\tconst responseDiscount = response?.discount as DiscountUnit | DiscountAmount | DiscountPercent\n\n\t\t\t\t\t\tswitch (responseDiscount.type) {\n\t\t\t\t\t\t\tcase 'AMOUNT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: responseDiscount.amount_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\tcase 'UNIT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: responseDiscount.unit_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\n\t\t\t\t\t\t\tcase 'PERCENT':\n\t\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tvoucherifyDiscountType: responseDiscount.type || '',\n\t\t\t\t\t\t\t\t\tvoucherifyAmountOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\t\t\tvoucherifyPercentOff: responseDiscount.percent_off || 0,\n\t\t\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyDiscountType: 'GIFT_CARD',\n\t\t\t\t\t\t\tvoucherifyAmountOff: response?.order?.total_discount_amount || 0,\n\t\t\t\t\t\t\tvoucherifyUnitOff: 0,\n\t\t\t\t\t\t\tvoucherifyPercentOff: 0,\n\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t}))\n\t\t\t\t\t}\n\n\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyValidate: true,\n\t\t\t\t\t}))\n\n\t\t\t\t\tif (typeof onValidated === 'function') onValidated(response)\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.error(err)\n\t\t\t\t\tif (err.key === 'missing_order') {\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyValidate: false,\n\t\t\t\t\t\t\tvoucherifyAmount: false,\n\t\t\t\t\t\t\tvoucherifyCode: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tsetSubmitting(false)\n\t\t\t\t\tsetRunValidateOnce(true)\n\t\t\t\t})\n\t\t},\n\t\t[input, onError, onValidated, amount],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder={textPlaceholder || 'e.g. abc-123'}\n\t\t\t\tname=\"voucherifyCode\"\n\t\t\t\tvalue={input['voucherifyCode']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyCode').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype={amount ? 'text' : 'hidden'}\n\t\t\t\tplaceholder={amountPlaceholder || 'e.g. 52.22'}\n\t\t\t\tname=\"voucherifyAmount\"\n\t\t\t\tvalue={input['voucherifyAmount']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyAmount').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyDiscountType\"\n\t\t\t\tvalue={input['voucherifyDiscountType']}\n\t\t\t\tclassName=\"voucherifyDiscountType\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyPercentOff\"\n\t\t\t\tvalue={input['voucherifyPercentOff']}\n\t\t\t\tclassName=\"voucherifyPercentOff\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyAmountOff\"\n\t\t\t\tvalue={input['voucherifyAmountOff']}\n\t\t\t\tclassName=\"voucherifyAmountOff\"\n\t\t\t/>\n\t\t\t<input type=\"hidden\" name=\"voucherifyUnitOff\" value={input['voucherifyUnitOff']} className=\"voucherifyUnitOff\" />\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyValidate').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t>\n\t\t\t\t<span className=\"voucherifyValidateText\">{textValidate}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifyPublishInputs, VoucherifyPublishInputsState } from '../types/VoucherifyPublish'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyPublishInputs {\n\treturn {\n\t\tname: '',\n\t\temail: '',\n\t\tphone: '',\n\t\tline_1: '',\n\t\tline_2: '',\n\t\tpostal_code: '',\n\t\tcity: '',\n\t\tstate: '',\n\t\tcountry: '',\n\t\tvoucherifyPublishStatus: '',\n\t\tvoucherifyTracking: '',\n\t\tvoucherifyPublish: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyPublishInputsState {\n\treturn {\n\t\tname: true,\n\t\tphone: true,\n\t\temail: true,\n\t\tline_1: true,\n\t\tline_2: true,\n\t\tpostal_code: true,\n\t\tcity: true,\n\t\tstate: true,\n\t\tcountry: true,\n\t\tvoucherifyPublishStatus: true,\n\t\tvoucherifyPublish: true,\n\t}\n}\n\nexport function useVoucherifyPublishInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifyPublishInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport { ClientSidePublishPayload, ClientSidePublishResponse, VoucherifyClientSideOptions } from '@voucherify/sdk'\nimport { removeEmptyAttributes, splitLongKey, validateEmail, validatePhoneNumber } from './helpers'\n\nimport { NotDefinedPlaceholder } from './types/VoucherifyPublish'\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyPublishInputs } from './hooks/useVoucherifyPublishInputs'\n\ninterface VoucherifyPublishOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonPublished?: (response: ClientSidePublishResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * name of the campaign to which voucher will be published\n\t */\n\tcampaignName: string\n\t/**\n\t * list of fields to be displayed on the widget\n\t */\n\tcustomerFields?: {\n\t\tname: 'name' | 'email' | 'phone' | 'line_1' | 'line_2' | 'city' | 'postal_code' | 'state' | 'country'\n\t\trequired: boolean\n\t}[]\n\t/**\n\t * a placeholder text to displayed on 'name' field from customerFields\n\t */\n\tcustomerNamePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'email' field from customerFields\n\t */\n\tcustomerEmailPlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'phone' field from customerFields\n\t */\n\tcustomerPhonePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'line_1' field from customerFields\n\t */\n\tcustomerLine1Placeholder?: string\n\t/**\n\t * a placeholder text to displayed on 'line_2' field from customerFields\n\t */\n\tcustomerLine2Placeholder?: string\n\t/**\n\t * a placeholder text to displayed on 'postal_code' field from customerFields\n\t */\n\tcustomerPostalCodePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'city' field from customerFields\n\t */\n\tcustomerCityPlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'state' field from customerFields\n\t */\n\tcustomerStatePlaceholder?: string\n\t/**\n\t * a placeholder text to displayed on 'country' field from customerFields\n\t */\n\tcustomerCountryPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Get Voucher\")\n\t */\n\ttextPublish?: string\n}\n\nexport function VoucherifyPublish({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonPublished,\n\tonError,\n\tcampaignName,\n\tcustomerFields = [],\n\tcustomerNamePlaceholder,\n\tcustomerEmailPlaceholder,\n\tcustomerPhonePlaceholder,\n\tcustomerLine1Placeholder,\n\tcustomerLine2Placeholder,\n\tcustomerPostalCodePlaceholder,\n\tcustomerCityPlaceholder,\n\tcustomerStatePlaceholder,\n\tcustomerCountryPlaceholder,\n\ttextPublish = 'Get voucher',\n}: VoucherifyPublishOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [visible, setVisible] = React.useState(true)\n\tconst [runPublishOnce, setRunPublishOnce] = React.useState(false)\n\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst { input, inputStates, onInputChange, resetInputs, setInput, setInputState } = useVoucherifyPublishInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(input).map(key => {\n\t\tlet className: string\n\n\t\tif (key === 'voucherifyPublishStatus' || key === 'voucherifyTracking' || key === 'voucherifyPublish') {\n\t\t\tclassName = key\n\t\t} else {\n\t\t\tclassName = `voucherifyCustomer${splitLongKey(key)}`\n\t\t}\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunPublishOnce ? (inputStates[key] ? '' : `${classNameInvalid} ${classNameInvalidAnimation}`) : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst notDefinedPlaceholders: NotDefinedPlaceholder = {\n\t\tname: 'e.g. Bruce Wayne',\n\t\temail: 'e.g. bruce@wayne.com',\n\t\tphone: 'e.g. +48 000 000 000',\n\t\tline_1: 'e.g. Wayne Manor',\n\t\tline_2: 'e.g. 22B',\n\t\tpostal_code: 'e.g. 00-0014',\n\t\tcity: 'e.g. Gotham',\n\t\tstate: 'e.g. New Jersey',\n\t\tcountry: 'e.g. USA',\n\t}\n\n\tconst createInput = (inputName: string, inputPlaceholder: string = '') => {\n\t\tlet inputType: string\n\n\t\tif (inputName === 'phone') {\n\t\t\tinputType = 'tel'\n\t\t} else if (inputName === 'email') {\n\t\t\tinputType = 'email'\n\t\t} else {\n\t\t\tinputType = 'text'\n\t\t}\n\t\treturn (\n\t\t\t<input\n\t\t\t\ttype={inputType}\n\t\t\t\tplaceholder={inputPlaceholder ? inputPlaceholder : notDefinedPlaceholders[`${inputName}`]}\n\t\t\t\tname={inputName}\n\t\t\t\tvalue={input[`${inputName}`]}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === inputName).classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t></input>\n\t\t)\n\t}\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetSubmitting(true)\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyPublishStatus: '',\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetRunPublishOnce(true)\n\n\t\t\tconst payload: ClientSidePublishPayload = {\n\t\t\t\tcustomer: {\n\t\t\t\t\tname: input.name,\n\t\t\t\t\tphone: input.phone.replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim(),\n\t\t\t\t\temail: input.email,\n\t\t\t\t\tsource_id: input.email,\n\t\t\t\t\taddress: {\n\t\t\t\t\t\tline_1: input.line_1,\n\t\t\t\t\t\tline_2: input.line_2,\n\t\t\t\t\t\tpostal_code: input.postal_code,\n\t\t\t\t\t\tcity: input.city,\n\t\t\t\t\t\tstate: input.state,\n\t\t\t\t\t\tcountry: input.country,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst inputStatesAfterValidation = customerFields.reduce(\n\t\t\t\t(result, field) => {\n\t\t\t\t\tif (field.required && input[field.name].trim() === '') {\n\t\t\t\t\t\tresult[field.name] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field.name === 'phone' && input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['phone'] = validatePhoneNumber(input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field.name === 'email' && input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['email'] = validateEmail(input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tresult[field.name] = true\n\t\t\t\t\treturn result\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname: true,\n\t\t\t\t\temail: true,\n\t\t\t\t\tphone: true,\n\t\t\t\t\tline_1: true,\n\t\t\t\t\tline_2: true,\n\t\t\t\t\tpostal_code: true,\n\t\t\t\t\tcity: true,\n\t\t\t\t\tstate: true,\n\t\t\t\t\tcountry: true,\n\t\t\t\t\tvoucherifyPublishStatus: true,\n\t\t\t\t\tvoucherifyPublish: true,\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tsetInputState(prev => ({\n\t\t\t\t...prev,\n\t\t\t\t...inputStatesAfterValidation,\n\t\t\t}))\n\n\t\t\tconst validationFailed = Object.values(inputStatesAfterValidation).some(val => !val)\n\n\t\t\tif (!validationFailed) {\n\t\t\t\tclient\n\t\t\t\t\t.publish(campaignName, sanitizedPayload)\n\t\t\t\t\t.then(function (_response) {\n\t\t\t\t\t\tconst response: ClientSidePublishResponse = _response\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\temail: '',\n\t\t\t\t\t\t\tphone: '',\n\t\t\t\t\t\t\tline_1: '',\n\t\t\t\t\t\t\tline_2: '',\n\t\t\t\t\t\t\tpostal_code: '',\n\t\t\t\t\t\t\tcity: '',\n\t\t\t\t\t\t\tstate: '',\n\t\t\t\t\t\t\tcountry: '',\n\t\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t\t\tvoucherifyPublishStatus: response.voucher.code,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tsetDisabled(true)\n\t\t\t\t\t\tsetVisible(false)\n\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyPublishStatus: true,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onPublished === 'function') onPublished(response)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifyPublish: false,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => setSubmitting(false))\n\t\t\t} else {\n\t\t\t\tsetSubmitting(false)\n\t\t\t}\n\t\t},\n\t\t[input, onError, onPublished],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer wide\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\n\t\t\t{customerFields.some(val => val.name === 'name') && createInput('name', customerNamePlaceholder)}\n\n\t\t\t{customerFields.some(val => val.name === 'email' || val.name === 'phone') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'email') && createInput('email', customerEmailPlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'phone') && createInput('phone', customerPhonePlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{customerFields.some(val => val.name === 'line_1') && createInput('line_1', customerLine1Placeholder)}\n\t\t\t{customerFields.some(val => val.name === 'line_2') && createInput('line_2', customerLine2Placeholder)}\n\n\t\t\t{customerFields.some(val => val.name === 'postal_code' || val.name === 'city') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code') &&\n\t\t\t\t\t\tcreateInput('postal_code', customerPostalCodePlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'city') && createInput('city', customerCityPlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{customerFields.some(val => val.name === 'state' || val.name === 'country') && (\n\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t{customerFields.some(val => val.name === 'state') && createInput('state', customerStatePlaceholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'country') && createInput('country', customerCountryPlaceholder)}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tname=\"voucherifyPublishStatus\"\n\t\t\t\tclassName={`voucherifyPublishStatus ${classNameValid} ${classNameValidAnimation}`}\n\t\t\t\tvalue={input['voucherifyPublishStatus']}\n\t\t\t\tstyle={{ display: !visible ? 'block' : 'none' }}\n\t\t\t/>\n\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyPublish').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t>\n\t\t\t\t<span className=\"VoucherifyPublishText\">{textPublish}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifyRedeemInputs, VoucherifyRedeemInputsState } from '../types/VoucherifyRedeem'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifyRedeemInputs {\n\treturn {\n\t\tvoucherifyCode: '',\n\t\tvoucherifyAmount: '',\n\t\tvoucherifyTracking: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifyRedeemInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyRedeem: false,\n\t}\n}\n\nfunction getEmptyValidInputState(): VoucherifyRedeemInputsState {\n\treturn {\n\t\tvoucherifyCode: false,\n\t\tvoucherifyAmount: false,\n\t\tvoucherifyRedeem: false,\n\t}\n}\n\nexport function useVoucherifyRedeemInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\tconst [inputValidStates, setValidInputState] = useState(getEmptyValidInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifyRedeemInputs\n\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tinputValidStates,\n\t\tsetValidInputState,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport { ClientSideRedeemResponse, ClientSideRedeemWidgetPayload, VoucherifyClientSideOptions } from '@voucherify/sdk'\n\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport clsx from 'clsx'\nimport { removeEmptyAttributes } from './helpers'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifyRedeemInputs } from './hooks/useVoucherifyRedeemInputs'\n\ninterface VoucherifyRedeemOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when entered code is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when entered code is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when entered code is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the entered code is valid, it takes the validation response as a parameter\n\t */\n\tonRedeemed?: (response: ClientSideRedeemResponse) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * flag enables the amount input field\n\t */\n\tamount?: boolean\n\t/**\n\t * text displayed as a placeholder in the code input field\n\t */\n\ttextPlaceholder?: string\n\t/**\n\t * text displayed as a placeholder in the amount input field (`amount: true` is required)\n\t */\n\tamountPlaceholder?: string\n\t/**\n\t * a text displayed on the button (default: \"Redeem\")\n\t */\n\ttextRedeem?: string\n}\n\nexport function VoucherifyRedeem({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tonRedeemed,\n\tonError,\n\tamount,\n\ttextPlaceholder,\n\tamountPlaceholder,\n\ttextRedeem = 'Redeem',\n}: VoucherifyRedeemOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [runRedeemOnce, setRunRedeemOnce] = React.useState(false)\n\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\n\tconst {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t\tinputValidStates,\n\t\tsetValidInputState,\n\t} = useVoucherifyRedeemInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst classNames: any[] = Object.keys(inputStates).map(key => {\n\t\tlet className: string = key\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunRedeemOnce ? (inputStates[key] ? `${classNameInvalid} ${classNameInvalidAnimation}` : '') : '',\n\t\t\trunRedeemOnce ? (inputValidStates[key] ? `${classNameValid} ${classNameValidAnimation}` : '') : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifyTracking: '',\n\t\t\t}))\n\n\t\t\tsetRunRedeemOnce(true)\n\n\t\t\tconst payload: ClientSideRedeemWidgetPayload = {\n\t\t\t\torder: {\n\t\t\t\t\tamount:\n\t\t\t\t\t\tinput.voucherifyAmount.trim() === '' ||\n\t\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t\t? 0\n\t\t\t\t\t\t\t: parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10),\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst code: string = input.voucherifyCode.replace(/[\\r\\n\\t\\f\\v]/g, '').trim()\n\n\t\t\tif (\n\t\t\t\t!code ||\n\t\t\t\t(input.voucherifyAmount.trim() !== '' &&\n\t\t\t\t\tisNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10)))\n\t\t\t) {\n\t\t\t\treturn setInputState(prev => ({\n\t\t\t\t\t...prev,\n\t\t\t\t\tvoucherifyCode: !code ? true : false,\n\t\t\t\t\tvoucherifyAmount:\n\t\t\t\t\t\tamount && isNaN(parseInt((parseFloat(input.voucherifyAmount.replace(/,/, '.')) * 100).toString(), 10))\n\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t: false,\n\t\t\t\t}))\n\t\t\t}\n\n\t\t\tsetSubmitting(true)\n\n\t\t\tclient\n\t\t\t\t.redeem(code, sanitizedPayload)\n\t\t\t\t.then(function (_response) {\n\t\t\t\t\tconst response: ClientSideRedeemResponse = _response\n\t\t\t\t\tif (!response || response.result !== 'SUCCESS') {\n\t\t\t\t\t\tsetInputState(prev => ({ ...prev, voucherifyRedeem: true }))\n\t\t\t\t\t}\n\n\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyTracking: response?.tracking_id || '',\n\t\t\t\t\t}))\n\n\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\tsetValidInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyRedeem: true,\n\t\t\t\t\t}))\n\n\t\t\t\t\tif (typeof onRedeemed === 'function') onRedeemed(response)\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.error(err)\n\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tvoucherifyRedeem: true,\n\t\t\t\t\t\tvoucherifyAmount: true,\n\t\t\t\t\t\tvoucherifyCode: true,\n\t\t\t\t\t}))\n\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t})\n\t\t\t\t.finally(() => setSubmitting(false))\n\t\t},\n\t\t[input, onError, onRedeemed, amount],\n\t)\n\n\treturn (\n\t\t<div className=\"voucherifyContainer\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\tplaceholder={textPlaceholder || 'e.g. abc-123'}\n\t\t\t\tname=\"voucherifyCode\"\n\t\t\t\tvalue={input['voucherifyCode']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyCode').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype={amount ? 'text' : 'hidden'}\n\t\t\t\tplaceholder={amountPlaceholder || 'e.g. 52.22'}\n\t\t\t\tname=\"voucherifyAmount\"\n\t\t\t\tvalue={input['voucherifyAmount']}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyAmount').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t/>\n\t\t\t<input\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tname=\"voucherifyTracking\"\n\t\t\t\tvalue={input['voucherifyTracking']}\n\t\t\t\tclassName=\"voucherifyTracking\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifyRedeem').classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tonClick={onSubmit}\n\t\t\t>\n\t\t\t\t<span className=\"voucherifyRedeemText\">{textRedeem}</span>\n\t\t\t</button>\n\t\t</div>\n\t)\n}\n","import { VoucherifySubscribeInputs, VoucherifySubscribeInputsState } from '../types/VoucherifySubscribe'\nimport { useCallback, useState } from 'react'\n\nfunction getEmptyInputs(): VoucherifySubscribeInputs {\n\treturn {\n\t\tname: '',\n\t\temail: '',\n\t\tphone: '',\n\t\tline_1: '',\n\t\tline_2: '',\n\t\tpostal_code: '',\n\t\tcity: '',\n\t\tstate: '',\n\t\tcountry: '',\n\t\tvoucherifySubscribeStatus: '',\n\t\tvoucherifySubscribe: '',\n\t}\n}\n\nfunction getEmptyInputState(): VoucherifySubscribeInputsState {\n\treturn {\n\t\tname: true,\n\t\tphone: true,\n\t\temail: true,\n\t\tline_1: true,\n\t\tline_2: true,\n\t\tpostal_code: true,\n\t\tcity: true,\n\t\tstate: true,\n\t\tcountry: true,\n\t\tvoucherifySubscribeStatus: true,\n\t\tvoucherifySubscribe: true,\n\t}\n}\n\nexport function useVoucherifySubscribeInputs() {\n\tconst [input, setInput] = useState(getEmptyInputs)\n\tconst [inputStates, setInputState] = useState(getEmptyInputState)\n\n\tconst onInputChange = useCallback(function onChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst name = event.target.name as keyof VoucherifySubscribeInputs\n\n\t\tif (event.target.value === 'off') {\n\t\t\tsetInput(prev => ({ ...prev, [name]: 'on' }))\n\t\t} else if (event.target.value === 'on') {\n\t\t\tsetInput(prev => ({ ...prev, [name]: 'off' }))\n\t\t} else {\n\t\t\tsetInput(prev => ({ ...prev, [name]: event.target.value }))\n\t\t}\n\t}, [])\n\n\tconst resetInputs = useCallback(function reset() {\n\t\tsetInput(getEmptyInputs)\n\t\tsetInputState(getEmptyInputState)\n\t}, [])\n\n\treturn {\n\t\tinput,\n\t\tinputStates,\n\t\tonInputChange,\n\t\tresetInputs,\n\t\tsetInput,\n\t\tsetInputState,\n\t}\n}\n","import * as React from 'react'\n\nimport {\n\tClientSideCustomersCreateParams,\n\tClientSideCustomersCreateResponse,\n\tVoucherifyClientSideOptions,\n} from '@voucherify/sdk'\nimport { removeEmptyAttributes, splitLongKey, validateEmail, validatePhoneNumber } from './helpers'\n\nimport { NotDefinedPlaceholder } from './types/VoucherifyPublish'\nimport { VoucherifyLogo } from './VoucherifyLogo'\nimport { VoucherifySubscribeLoadedConsents } from './types/VoucherifySubscribe'\nimport clsx from 'clsx'\nimport { useVoucherifyClient } from './hooks/useVoucherifyClient'\nimport { useVoucherifySubscribeInputs } from './hooks/useVoucherifySubscribeInputs'\n\nconst UNCONFIRMED_CUSTOMER = 'Confirm your subscription to our list. Check your email for further instructions.'\nconst ERROR_MESSAGE =\n\t'We ran into a configuration error. Please try that again. If the error persists, please contact support.'\n\ninterface WidgetFields {\n\tname?: 'name' | 'email' | 'phone' | 'line_1' | 'line_2' | 'city' | 'postal_code' | 'state' | 'country'\n\trequired: boolean\n\tplaceholder?: string\n\tid?: string\n}\n\ninterface Consents {\n\tid: string\n\trequired: boolean\n}\ninterface VoucherifySubscribeOptions extends VoucherifyClientSideOptions {\n\t/**\n\t * CSS class applied to the input when data is invalid\n\t */\n\tclassInvalid?: string\n\t/**\n\t * CSS class describing animation of the input field when data is invalid\n\t */\n\tclassInvalidAnimation?: string\n\t/**\n\t * CSS class applied to the input when data is valid\n\t */\n\tclassValid?: string\n\t/**\n\t * CSS class describing animation of the input field when data is valid\n\t */\n\tclassValidAnimation?: string\n\t/**\n\t * source of the image appearing in the circle at the top\n\t */\n\tlogoSrc?: string\n\t/**\n\t * alt message of the image appearing in the circle at the top\n\t */\n\tlogoAlt?: string\n\t/**\n\t * a callback function invoked when the data is valid, it takes the updateConsents response as a parameter\n\t */\n\tonSubscribed?: (response: any) => void\n\t/**\n\t * a callback function invoked when there is an error\n\t */\n\tonError?: (error: any) => void\n\t/**\n\t * require customer to confirm subscription by email\n\t */\n\tenableDoubleOptIn?: boolean\n\t/**\n\t * list of fields to be displayed on the widget\n\t */\n\tcustomerFields?: WidgetFields[]\n\t/**\n\t * a placeholder text to displayed on required 'email' field\n\t */\n\temailPlaceholder: string\n\t/**\n\t * list of consent objects to be displayed on the widget\n\t */\n\tconsents: Consents[]\n\t/**\n\t * a text displayed on the button (default: \"Subscribe\")\n\t */\n\ttextSubscribe?: string\n\t/**\n\t * a text displayed after successful subscription (default: \"Thank you for subscribing\")\n\t */\n\ttextSubscribeSuccess?: string\n}\n\nexport function VoucherifySubscribe({\n\tapiUrl,\n\tclientApplicationId,\n\tclientSecretKey,\n\ttrackingId,\n\torigin,\n\tclassInvalid,\n\tclassInvalidAnimation,\n\tclassValid,\n\tclassValidAnimation,\n\tlogoSrc,\n\tlogoAlt,\n\tconsents,\n\tonSubscribed,\n\tonError,\n\temailPlaceholder,\n\tcustomerFields = [],\n\tenableDoubleOptIn = false,\n\ttextSubscribe = 'Subscribe',\n\ttextSubscribeSuccess = 'Thank you for subscribing',\n}: VoucherifySubscribeOptions) {\n\tconst classNameInvalid = classInvalid || 'voucherifyInvalid'\n\tconst classNameValid = classValid || 'voucherifyValid'\n\tconst classNameInvalidAnimation = classInvalidAnimation || 'voucherifyAnimationShake'\n\tconst classNameValidAnimation = classValidAnimation || 'voucherifyAnimationTada'\n\n\tconst [allDisabled, setDisabled] = React.useState(false)\n\tconst [visible, setVisible] = React.useState(true)\n\tconst [runSubscribeOnce, setRunSubscribeOnce] = React.useState(false)\n\tconst [consentsError, setConsentsError] = React.useState(false)\n\tconst [loading, setLoading] = React.useState(true)\n\tconst [client, isSubmitting, setSubmitting] = useVoucherifyClient({\n\t\tapiUrl,\n\t\tclientApplicationId,\n\t\tclientSecretKey,\n\t\ttrackingId,\n\t\torigin,\n\t})\n\tconst [loadedConsents, setLoadedConsents] = React.useState<VoucherifySubscribeLoadedConsents>([])\n\n\tconst widgetFields: WidgetFields[] = [\n\t\t...customerFields,\n\t\t{ name: 'email', required: true, placeholder: emailPlaceholder },\n\t\t...consents,\n\t]\n\n\tconst { input, inputStates, onInputChange, resetInputs, setInput, setInputState } = useVoucherifySubscribeInputs()\n\n\tReact.useEffect(() => {\n\t\tresetInputs()\n\t\tsetDisabled(false)\n\t}, [client])\n\n\tconst onRender = React.useCallback(\n\t\tfunction _onRender() {\n\t\t\tif (!enableDoubleOptIn && consents !== [] && consents !== undefined) {\n\t\t\t\tclient\n\t\t\t\t\t.listConsents()\n\t\t\t\t\t.then(fetchedData => {\n\t\t\t\t\t\tconst fetchedConsents = fetchedData.consents.data\n\t\t\t\t\t\tconst filteredConsents = fetchedConsents.filter(o1 => consents.some(o2 => o1.id === o2?.id))\n\t\t\t\t\t\tif (filteredConsents.length === 0 || filteredConsents.length !== consents.length) {\n\t\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus: true,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetConsentsError(true)\n\t\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst foundConsents: any = {}\n\t\t\t\t\t\t\tconst foundConsentsStates: any = {}\n\n\t\t\t\t\t\t\tfilteredConsents.forEach(consent => {\n\t\t\t\t\t\t\t\tfoundConsents[consent.id] = ''\n\t\t\t\t\t\t\t\tfoundConsentsStates[consent.id] = true\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t...foundConsents,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t...foundConsentsStates,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\tsetLoadedConsents(filteredConsents)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetLoading(false)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tsetLoading(false)\n\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribe: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tsetLoading(false)\n\t\t\t}\n\t\t},\n\t\t[enableDoubleOptIn, consentsError],\n\t)\n\n\tReact.useEffect(() => {\n\t\tonRender()\n\t}, [onRender])\n\n\tconst classNames: any[] = Object.keys(input).map(key => {\n\t\tlet className: string\n\n\t\tif (key === 'voucherifySubscribeStatus' || key === 'voucherifySubscribe') {\n\t\t\tclassName = key\n\t\t} else {\n\t\t\tclassName = `voucherifyCustomer${splitLongKey(key)}`\n\t\t}\n\n\t\tconst classes = clsx([\n\t\t\tclassName,\n\t\t\trunSubscribeOnce ? (inputStates[key] ? '' : `${classNameInvalid} ${classNameInvalidAnimation}`) : '',\n\t\t])\n\n\t\treturn {\n\t\t\tname: key,\n\t\t\tclasses,\n\t\t}\n\t})\n\n\tconst notDefinedPlaceholders: NotDefinedPlaceholder = {\n\t\tname: 'e.g. Bruce Wayne',\n\t\temail: 'e.g. bruce@wayne.com',\n\t\tphone: 'e.g. +48 000 000 000',\n\t\tline_1: 'e.g. Wayne Manor',\n\t\tline_2: 'e.g. 22B',\n\t\tpostal_code: 'e.g. 00-0014',\n\t\tcity: 'e.g. Gotham',\n\t\tstate: 'e.g. New Jersey',\n\t\tcountry: 'e.g. USA',\n\t}\n\n\tconst createInput = (inputName: string, inputPlaceholder: string = '') => {\n\t\tlet inputType: string\n\n\t\tif (inputName === 'phone') {\n\t\t\tinputType = 'tel'\n\t\t} else if (inputName === 'email') {\n\t\t\tinputType = 'email'\n\t\t} else {\n\t\t\tinputType = 'text'\n\t\t}\n\t\treturn (\n\t\t\t<input\n\t\t\t\ttype={inputType}\n\t\t\t\tplaceholder={inputPlaceholder ? inputPlaceholder : notDefinedPlaceholders[`${inputName}`]}\n\t\t\t\tname={inputName}\n\t\t\t\tvalue={input[`${inputName}`]}\n\t\t\t\tonChange={onInputChange}\n\t\t\t\tclassName={classNames.find((cls: any) => cls.name === inputName).classes}\n\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t></input>\n\t\t)\n\t}\n\n\tconst onSubmit = React.useCallback(\n\t\tfunction onSubmit(_event: React.MouseEvent<HTMLButtonElement, MouseEvent>) {\n\t\t\tsetSubmitting(true)\n\t\t\tsetInput(prev => ({\n\t\t\t\t...prev,\n\t\t\t\tvoucherifySubscribeStatus: '',\n\t\t\t}))\n\n\t\t\tsetRunSubscribeOnce(true)\n\n\t\t\tconst payload: ClientSideCustomersCreateParams = {\n\t\t\t\tsource_id: input.email,\n\t\t\t\tname: input.name,\n\t\t\t\tphone: input.phone.replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim(),\n\t\t\t\temail: input.email,\n\t\t\t\taddress: {\n\t\t\t\t\tline_1: input.line_1,\n\t\t\t\t\tline_2: input.line_2,\n\t\t\t\t\tpostal_code: input.postal_code,\n\t\t\t\t\tcity: input.city,\n\t\t\t\t\tstate: input.state,\n\t\t\t\t\tcountry: input.country,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tconst sanitizedPayload = removeEmptyAttributes(payload)\n\n\t\t\tconst inputStatesAfterValidation = widgetFields.reduce(\n\t\t\t\t(result, field) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t!enableDoubleOptIn &&\n\t\t\t\t\t\tfield?.required &&\n\t\t\t\t\t\tfield?.id &&\n\t\t\t\t\t\t(input[field.id] === 'off' || input[field.id].trim() === '')\n\t\t\t\t\t) {\n\t\t\t\t\t\tresult[field.id] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.required && field?.name && input[field.name].trim() === '') {\n\t\t\t\t\t\tresult[field.name] = false\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name === 'phone' && input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['phone'] = validatePhoneNumber(input['phone'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name === 'email' && input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim() !== '') {\n\t\t\t\t\t\tresult['email'] = validateEmail(input['email'].replace(/[\\r\\n\\t\\f\\s\\v]/g, '').trim())\n\t\t\t\t\t\treturn result\n\t\t\t\t\t}\n\t\t\t\t\tif (field?.name) {\n\t\t\t\t\t\tresult[field.name] = true\n\t\t\t\t\t} else if (field?.id) {\n\t\t\t\t\t\tresult[field.id] = true\n\t\t\t\t\t}\n\t\t\t\t\treturn result\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t...inputStates,\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tsetInputState(prev => ({\n\t\t\t\t...prev,\n\t\t\t\t...inputStatesAfterValidation,\n\t\t\t}))\n\n\t\t\tconst validationFailed = Object.values(inputStatesAfterValidation).some(val => !val)\n\n\t\t\tif (!validationFailed) {\n\t\t\t\tclient\n\t\t\t\t\t.createCustomer(sanitizedPayload, enableDoubleOptIn)\n\t\t\t\t\t.then(function (_response: ClientSideCustomersCreateResponse) {\n\t\t\t\t\t\tif (_response.object === 'unconfirmed_customer') {\n\t\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus: UNCONFIRMED_CUSTOMER,\n\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribeStatus: textSubscribeSuccess,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (loadedConsents.length !== 0) {\n\t\t\t\t\t\t\tconst createdCustomerId = _response.id\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\temail,\n\t\t\t\t\t\t\t\tphone,\n\t\t\t\t\t\t\t\tline_1,\n\t\t\t\t\t\t\t\tline_2,\n\t\t\t\t\t\t\t\tpostal_code,\n\t\t\t\t\t\t\t\tcity,\n\t\t\t\t\t\t\t\tstate,\n\t\t\t\t\t\t\t\tcountry,\n\t\t\t\t\t\t\t\tvoucherifySubscribeStatus,\n\t\t\t\t\t\t\t\tvoucherifySubscribe,\n\t\t\t\t\t\t\t\tvoucherifyTracking,\n\t\t\t\t\t\t\t\t...consents\n\t\t\t\t\t\t\t} = input\n\n\t\t\t\t\t\t\tObject.keys(consents).forEach(function (key) {\n\t\t\t\t\t\t\t\tconsents[key] = consents[key] === 'on'\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\treturn client.updateConsents(createdCustomerId, consents)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn\n\t\t\t\t\t})\n\t\t\t\t\t.then(function (_response) {\n\t\t\t\t\t\tsetDisabled(true)\n\n\t\t\t\t\t\tsetVisible(false)\n\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribeStatus: true,\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tsetInput(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tname: '',\n\t\t\t\t\t\t\temail: '',\n\t\t\t\t\t\t\tphone: '',\n\t\t\t\t\t\t\tline_1: '',\n\t\t\t\t\t\t\tline_2: '',\n\t\t\t\t\t\t\tpostal_code: '',\n\t\t\t\t\t\t\tcity: '',\n\t\t\t\t\t\t\tstate: '',\n\t\t\t\t\t\t\tcountry: '',\n\t\t\t\t\t\t\tvoucherifySubscribe: '',\n\t\t\t\t\t\t}))\n\n\t\t\t\t\t\tif (typeof onSubscribed === 'function') onSubscribed(_response)\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tsetVisible(false)\n\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\tsetInputState(prev => ({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tvoucherifySubscribe: false,\n\t\t\t\t\t\t}))\n\t\t\t\t\t\tsetInput(prev => ({ ...prev, voucherifySubscribeStatus: ERROR_MESSAGE }))\n\n\t\t\t\t\t\tif (typeof onError === 'function') onError(err)\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => setSubmitting(false))\n\t\t\t} else {\n\t\t\t\tsetSubmitting(false)\n\t\t\t}\n\t\t},\n\t\t[input, onError, onSubscribed],\n\t)\n\treturn (\n\t\t<div className=\"voucherifyContainer wide\">\n\t\t\t<VoucherifyLogo src={logoSrc} alt={logoAlt} />\n\n\t\t\t{loading ? (\n\t\t\t\t<div className=\"loader\">Loading consents...</div>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{customerFields.some(val => val.name === 'name') &&\n\t\t\t\t\t\tcreateInput('name', customerFields.find(field => field.name === 'name')?.placeholder)}\n\n\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t{createInput('email', emailPlaceholder)}\n\t\t\t\t\t\t{customerFields.some(val => val.name === 'phone') &&\n\t\t\t\t\t\t\tcreateInput('phone', customerFields.find(field => field.name === 'phone')?.placeholder)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'line_1') &&\n\t\t\t\t\t\tcreateInput('line_1', customerFields.find(field => field.name === 'line_1')?.placeholder)}\n\t\t\t\t\t{customerFields.some(val => val.name === 'line_2') &&\n\t\t\t\t\t\tcreateInput('line_2', customerFields.find(field => field.name === 'line_2')?.placeholder)}\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code' || val.name === 'city') && (\n\t\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'postal_code') &&\n\t\t\t\t\t\t\t\tcreateInput('postal_code', customerFields.find(field => field.name === 'postal_code')?.placeholder)}\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'city') &&\n\t\t\t\t\t\t\t\tcreateInput('city', customerFields.find(field => field.name === 'city')?.placeholder)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{customerFields.some(val => val.name === 'state' || val.name === 'country') && (\n\t\t\t\t\t\t<div className=\"voucherifyRow\" style={{ display: visible ? 'flex' : 'none' }}>\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'state') &&\n\t\t\t\t\t\t\t\tcreateInput('state', customerFields.find(field => field.name === 'state')?.placeholder)}\n\t\t\t\t\t\t\t{customerFields.some(val => val.name === 'country') &&\n\t\t\t\t\t\t\t\tcreateInput('country', customerFields.find(field => field.name === 'country')?.placeholder)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\tconsentsError\n\t\t\t\t\t\t\t\t? `voucherifySubscribeStatus ${classNameInvalid} ${classNameInvalidAnimation}`\n\t\t\t\t\t\t\t\t: `voucherifySubscribeStatus ${classNameValid} ${classNameValidAnimation}`\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyle={{ display: !visible ? 'block' : 'none' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<p>{input['voucherifySubscribeStatus']}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{!enableDoubleOptIn &&\n\t\t\t\t\t\tloadedConsents.length !== 0 &&\n\t\t\t\t\t\tloadedConsents.map((consent: any) => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{classNames.some(val => val.name === consent.id) && (\n\t\t\t\t\t\t\t\t\t<label className=\"voucherifyCheckboxContainer\" style={{ display: visible ? 'block' : 'none' }}>\n\t\t\t\t\t\t\t\t\t\t{consent.description}\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\t\tid={consent.name}\n\t\t\t\t\t\t\t\t\t\t\tname={consent.id}\n\t\t\t\t\t\t\t\t\t\t\tonChange={onInputChange}\n\t\t\t\t\t\t\t\t\t\t\tvalue={input[consent.id] === 'on' ? 'on' : 'off'}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\tclassName={`voucherifyCheckmark ${\n\t\t\t\t\t\t\t\t\t\t\t\tclassNames.find((cls: any) => cls.name === consent.id).classes\n\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t></span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t))}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName={classNames.find((cls: any) => cls.name === 'voucherifySubscribe').classes}\n\t\t\t\t\t\tdisabled={isSubmitting || allDisabled}\n\t\t\t\t\t\tonClick={onSubmit}\n\t\t\t\t\t\tstyle={{ display: visible ? 'block' : 'none' }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"voucherifySubscribeText\">{textSubscribe}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n"],"names":["VoucherifyLogo","src","alt","React","className","viewBox","fill","d","toVal","mix","k","y","str","Array","isArray","length","i","tmp","x","arguments","capitalizeString","string","charAt","toUpperCase","slice","splitLongKey","key","split","map","join","removeEmptyAttributes","obj","Object","keys","forEach","undefined","validatePhoneNumber","phoneNumber","re","test","validateEmail","email","toLowerCase","useVoucherifyClient","options","useState","VoucherifyClientSide","client","setClient","isSubmitting","setSubmitting","useEffect","apiUrl","clientApplicationId","clientSecretKey","trackingId","origin","getEmptyInputs","voucherifyCode","voucherifyAmount","voucherifyDiscountType","voucherifyPercentOff","voucherifyAmountOff","voucherifyUnitOff","voucherifyTracking","getEmptyInputState","voucherifyValidate","useVoucherifyValidateInputs","input","setInput","inputState","setInputState","onInputChange","useCallback","onChange","event","persist","name","target","prev","value","resetInputs","reset","VoucherifyValidate","classInvalid","classInvalidAnimation","classValid","classValidAnimation","logoSrc","logoAlt","onValidated","onError","amount","textPlaceholder","amountPlaceholder","textValidate","classNameInvalid","classNameValid","classNameInvalidAnimation","classNameValidAnimation","allDisabled","setDisabled","runValidateOnce","setRunValidateOnce","classNames","classes","clsx","onSubmit","_event","trim","payload","code","isNaN","parseInt","parseFloat","replace","toString","sanitizedPayload","validate","then","_response","response","valid","discount","responseDiscount","type","amount_off","tracking_id","unit_off","percent_off","order","total_discount_amount","err","console","error","placeholder","find","cls","disabled","onClick","phone","line_1","line_2","postal_code","city","state","country","voucherifyPublishStatus","voucherifyPublish","useVoucherifyPublishInputs","inputStates","VoucherifyPublish","onPublished","campaignName","customerFields","customerNamePlaceholder","customerEmailPlaceholder","customerPhonePlaceholder","customerLine1Placeholder","customerLine2Placeholder","customerPostalCodePlaceholder","customerCityPlaceholder","customerStatePlaceholder","customerCountryPlaceholder","textPublish","visible","setVisible","runPublishOnce","setRunPublishOnce","notDefinedPlaceholders","createInput","inputName","inputPlaceholder","inputType","style","display","customer","source_id","address","inputStatesAfterValidation","reduce","result","field","required","validationFailed","values","some","val","publish","voucher","voucherifyRedeem","getEmptyValidInputState","useVoucherifyRedeemInputs","inputValidStates","setValidInputState","VoucherifyRedeem","onRedeemed","textRedeem","runRedeemOnce","setRunRedeemOnce","redeem","voucherifySubscribeStatus","voucherifySubscribe","useVoucherifySubscribeInputs","UNCONFIRMED_CUSTOMER","ERROR_MESSAGE","VoucherifySubscribe","consents","onSubscribed","emailPlaceholder","enableDoubleOptIn","textSubscribe","textSubscribeSuccess","runSubscribeOnce","setRunSubscribeOnce","consentsError","setConsentsError","loading","setLoading","loadedConsents","setLoadedConsents","widgetFields","onRender","_onRender","listConsents","fetchedData","fetchedConsents","data","filteredConsents","filter","o1","o2","id","foundConsents","foundConsentsStates","consent","createCustomer","object","createdCustomerId","updateConsents","description"],"mappings":"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"}